# 网络配置切换工具

一个用于快速切换Windows网络配置的GUI工具，支持IP、网关、子网掩码和DNS设置的手动配置与自动获取模式切换。

## 功能特性

- **网络配置管理**：支持手动设置IP、网关、子网掩码和DNS服务器
- **自动获取模式**：一键切换回DHCP自动获取配置
- **系统托盘集成**：最小化到系统托盘，支持右键菜单快速操作
- **物理网卡过滤**：只显示物理网络设备，过滤虚拟设备
- **配置历史**：保存配置历史，支持快速应用历史配置
- **友好界面**：使用友好的网络接口名称，而非GUID

## 系统要求

- Windows 7或更高版本
- Python 3.7或更高版本（源代码运行）
- 管理员权限（修改网络配置需要）

## 运行方式

### 方法1：直接运行可执行文件

1. 从`dist`目录中找到`网络配置切换工具.exe`
2. 右键点击，选择"以管理员身份运行"
3. 填写网络配置信息，点击"应用配置"按钮

### 方法2：从源代码运行

1. 安装依赖：`pip install pywin32`
2. 运行：`python switchDNS.py`（需要管理员权限）

## 使用说明

1. **选择网络接口**：从下拉列表中选择需要配置的网络接口
2. **填写配置信息**：
   - IP地址：填写静态IP地址
   - 子网掩码：默认255.255.255.0
   - 网关：填写默认网关
   - DNS服务器：填写DNS服务器地址，多个DNS用逗号分隔
3. **应用配置**：点击"应用配置"按钮
4. **恢复自动获取**：点击"自动获取配置"按钮
5. **系统托盘操作**：
   - 点击最小化按钮将程序最小化到系统托盘
   - 右键点击系统托盘图标，可快速操作

## 注意事项

- **必须以管理员身份运行**：修改网络配置需要管理员权限
- **网络接口选择**：确保选择正确的网络接口
- **DNS配置**：多个DNS服务器之间用逗号分隔
- **系统托盘**：如果系统托盘功能不可用，程序会显示警告信息

## 编译说明

如需重新编译可执行文件，请运行：

```bash
# 带命令行窗口
python -m PyInstaller --onefile --name "网络配置切换工具" --distpath dist switchDNS.py

# 无命令行窗口
python -m PyInstaller --onefile --noconsole --name "网络配置切换工具" --distpath dist switchDNS.py
```

## 常见问题

### Q: 运行时提示"需要管理员权限"
A: 请右键点击程序，选择"以管理员身份运行"

### Q: 系统托盘图标不显示
A: 可能是pywin32库版本问题，程序会自动降级为普通窗口模式

### Q: 网络接口列表为空
A: 程序会自动使用默认网络接口名称，如"以太网"、"WLAN"等

## 许可证

本项目采用MIT许可证